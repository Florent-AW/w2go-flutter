# ğŸ“± SystÃ¨me de Bottom Bars - Documentation Technique

## ğŸ“‹ Vue d'ensemble

Le systÃ¨me de bottom bars de l'application suit une architecture **Atomic Design** stricte, permettant une rÃ©utilisabilitÃ© maximale et une cohÃ©rence visuelle parfaite entre toutes les bottom bars de l'application.

### ğŸ¯ Objectifs atteints
- âœ… **Architecture modulaire** - Composants rÃ©utilisables par niveau
- âœ… **CohÃ©rence visuelle** - MÃªme hauteur et style sur toutes les pages
- âœ… **FlexibilitÃ©** - Support de diffÃ©rents types de contenus
- âœ… **Performance** - Ã‰tats de loading intÃ©grÃ©s
- âœ… **MaintenabilitÃ©** - SÃ©paration claire des responsabilitÃ©s

---

## ğŸ“ Architecture des fichiers

### ğŸ”§ Core Components (Atoms & Molecules)

#### `lib/core/theme/components/atoms/bottom_bar_container.dart`
**Atom UI** - Container de base pour toutes les bottom bars

```dart
// Features :
// - Padding et ombres standardisÃ©s
// - SafeArea automatique
// - Couleur de fond adaptative au thÃ¨me
// - Personnalisation via paramÃ¨tres optionnels
```

#### `lib/core/theme/components/atoms/action_button.dart`
**Atom UI** - Bouton standardisÃ© pour toutes les bottom bars

```dart
// Features :
// - IcÃ´ne + texte vertical
// - Effet ripple optimisÃ© et centrÃ©
// - Ã‰tats enabled/disabled automatiques
// - Taille et padding normalisÃ©s
```

#### `lib/core/theme/components/molecules/bottom_bar_wrapper.dart`
**Molecule** - Combine BottomBarContainer + logique d'Ã©tat

```dart
// Features :
// - Ã‰tats loading, error, content
// - Skeleton automatique pour loading
// - Utilise BottomBarContainer comme base
// - Padding horizontal supprimÃ© pour full-width
```

### ğŸ¨ Shared UI Components

#### `lib/features/shared_ui/presentation/widgets/molecules/navigation_buttons_row.dart`
**Molecule** - Boutons de navigation principale (4 tabs)

```dart
// Features :
// - Enum BottomNavTab (explorer, favoris, lyra, profil)
// - Indicateur 3px accent au-dessus du tab actif
// - Espacement prÃ©cis : moitiÃ©-espace | bouton | espace | bouton...
// - Utilise ActionButton pour cohÃ©rence
```

#### `lib/features/shared_ui/presentation/widgets/organisms/generic_bottom_bar.dart`
**Organisme** - Bottom bar gÃ©nÃ©rique de navigation

```dart
// Features :
// - Combine BottomBarWrapper + NavigationButtonsRow
// - Export de BottomNavTab pour les templates
// - Ã‰tats loading intÃ©grÃ©s
// - Callback onTabSelected pour navigation
```

### ğŸ—ï¸ Feature-Specific Components

#### `lib/features/activity_detail/presentation/molecules/action_buttons_row.dart`
**Molecule** - Boutons spÃ©cifiques aux dÃ©tails d'activitÃ©

```dart
// Features :
// - 3 boutons : Maps/Navigation, TÃ©lÃ©phone, Site web
// - Utilise ActionButton pour cohÃ©rence de hauteur
// - Import du core/theme pour ActionButton
// - Logique mÃ©tier intÃ©grÃ©e (ExternalLauncherService)
```

#### `lib/features/activity_detail/presentation/organisms/floating_action_bar.dart`
**Organisme** - Bottom bar spÃ©cialisÃ©e pour les dÃ©tails d'activitÃ©

```dart
// Features :
// - Utilise BottomBarWrapper (pas GenericBottomBar)
// - IntÃ¨gre ActionButtonsRow pour les actions spÃ©cifiques
// - Ã‰tats Riverpod : loading, error, loaded
// - Hauteur identique Ã  GenericBottomBar grÃ¢ce Ã  ActionButton
```

---

## ğŸš€ Utilisation

### Navigation gÃ©nÃ©rale
```dart
// Dans CategoryPageTemplate
bottomNavigationBar: GenericBottomBar(
  selectedTab: BottomNavTab.explorer,
  onTabSelected: (tab) {
    // Navigation vers les autres sections
    Navigator.pushNamed(context, tab.route);
  },
),
```

### Actions spÃ©cifiques
```dart
// Dans ActivityDetailPage
bottomNavigationBar: FloatingActionBar(
  activityId: widget.activityId,
),
```

### Custom bottom bar
```dart
// Nouvelle feature
bottomNavigationBar: BottomBarWrapper(
  content: CustomButtonsRow(
    // Utiliser ActionButton pour cohÃ©rence
  ),
),
```

---

## ğŸ”§ Principes de design

### Atomic Design respectÃ©
```
Atoms (bottom_bar_container, action_button)
    â†“
Molecules (bottom_bar_wrapper, navigation_buttons_row)
    â†“
Organisms (generic_bottom_bar, floating_action_bar)
    â†“
Templates (category_page_template)
```

### CohÃ©rence visuelle garantie
- **Hauteur identique** : ActionButton normalise toutes les hauteurs
- **Padding standardisÃ©** : BottomBarWrapper gÃ¨re l'espacement
- **Ã‰tats cohÃ©rents** : Loading, error, content partout
- **Espacement prÃ©cis** : Calculs mathÃ©matiques pour l'alignement

### Performance optimisÃ©e
- **RepaintBoundary** automatique sur les boutons
- **Ã‰tats de loading** avec skeleton standardisÃ©
- **SafeArea** gÃ©rÃ© automatiquement

---

## â• Ajouter une nouvelle bottom bar

### 1. CrÃ©er la molecule des boutons
```dart
// lib/features/ma_feature/presentation/widgets/molecules/ma_buttons_row.dart
class MaButtonsRow extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Row(
      children: [
        Expanded(
          child: ActionButton( // âœ… Utiliser ActionButton
            icon: Icons.my_icon,
            label: 'Mon Action',
            onPressed: () => _onAction(),
          ),
        ),
        // ... autres boutons
      ],
    );
  }
}
```

### 2. CrÃ©er l'organisme
```dart
// lib/features/ma_feature/presentation/widgets/organisms/ma_bottom_bar.dart
class MaBottomBar extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return BottomBarWrapper( // âœ… Utiliser BottomBarWrapper
      content: MaButtonsRow(),
      isLoading: false,
    );
  }
}
```

### 3. IntÃ©grer dans la page
```dart
// Dans le Scaffold
bottomNavigationBar: MaBottomBar(),
```

---

## ğŸ¨ Customisation

### Modifier l'apparence globale
```dart
// Dans bottom_bar_container.dart
const defaultShadows = [
  BoxShadow(
    color: Colors.black12,
    blurRadius: 8,
    offset: Offset(0, -1),
  ),
];
```

### Ajouter un nouveau type de navigation
```dart
// Dans navigation_buttons_row.dart
enum BottomNavTab { 
  explorer, favoris, lyra, profil, 
  nouveauTab // âœ… Ajouter ici
}
```

### Modifier l'indicateur
```dart
// Dans navigation_buttons_row.dart
Container(
  height: 4, // âœ… Modifier l'Ã©paisseur
  color: isSelected ? AppColors.primary : Colors.transparent, // âœ… Modifier la couleur
)
```

---

## âš ï¸ RÃ¨gles importantes

1. **TOUJOURS utiliser ActionButton** pour les boutons de bottom bar
2. **JAMAIS importer de molecule** dans une template (seulement organisms)
3. **TOUJOURS passer par BottomBarWrapper** pour les nouvelles bottom bars
4. **RESPECTER l'Atomic Design** : Atoms â†’ Molecules â†’ Organisms â†’ Templates
5. **TESTER la cohÃ©rence de hauteur** entre toutes les bottom bars

---

## ğŸ§ª Tests de cohÃ©rence

### Checklist validation
- [ ] Toutes les bottom bars ont la mÃªme hauteur
- [ ] L'effet ripple est centrÃ© sur tous les boutons
- [ ] Les Ã©tats loading fonctionnent partout
- [ ] L'indicateur de navigation s'affiche correctement
- [ ] Pas de dÃ©bordement horizontal sur aucun Ã©cran
- [ ] SafeArea respectÃ© sur tous les devices

### Tests edge-cases
- âœ… Rotation Ã©cran (responsive)
- âœ… TrÃ¨s petits Ã©crans
- âœ… TrÃ¨s grands Ã©crans (tablets)
- âœ… Mode sombre/clair
- âœ… AccessibilitÃ© (TalkBack/VoiceOver)

---

Cette architecture garantit une Ã©volutivitÃ© et une maintenabilitÃ© optimales du systÃ¨me de bottom bars de l'application ! ğŸš€